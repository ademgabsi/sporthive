{% extends 'base.html.twig' %}

{% block title %}Nos Terrains - SPORTHIVE{% endblock %}

{% block body %}
<section class="terrain_section layout_padding">
    <div class="container">
        <div class="heading_container">
            <h2>Nos Terrains Disponibles</h2>
        </div>

        <!-- Champ de recherche -->
        <div class="row mb-4">
            <div class="col-md-6 mx-auto">
                <input type="text" id="searchInput" class="form-control" 
                       placeholder="Rechercher par nom, localisation ou prix...">
            </div>
        </div>

        <div class="row" id="terrainContainer">
            {% for terrain in terrains %}
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="terrain-card">
                        <div class="card-header">
                            <h5>{{ terrain.Nom }}</h5>
                        </div>
                        <div class="card-body">
                            <ul class="terrain-details">
                                <li><span class="detail-label">Localisation:</span> <span class="detail-value">{{ terrain.Localisation }}</span></li>
                                <li><span class="detail-label">Prix:</span> <span class="detail-value">{{ terrain.Prix }} TND</span></li>
                            </ul>
                            <div class="terrain-image mt-3">
                                {% if terrain.imageTer %}
                                    <img src="{{ asset('uploads/terrains/' ~ terrain.imageTer) }}" alt="Terrain" class="img-fluid rounded">
                                {% else %}
                                    <p>Aucune image disponible</p>
                                {% endif %}
                            </div>
                        </div>
                        <div class="card-footer">
                            <a href="{{ path('app_terrain_show', {'idTerrain': terrain.idTerrain}) }}" class="btn-view">Détails</a>
                            <a href="{{ path('app_reservation_new', {'id_Terrain': terrain.idTerrain}) }}" class="btn btn-outline-warning btn-sm">Reserver</a>
                        </div>
                    </div>
                </div>
            {% else %}
                <div class="col-12 text-center">
                    <div class="no-records">
                        <img src="{{ asset('img/empty.png') }}" alt="Aucun terrain" class="mb-3">
                        <p>Aucun terrain n'est disponible pour le moment</p>
                    </div>
                </div>
            {% endfor %}
        </div>

        <!-- Message aucun résultat -->
        <div id="noResults" class="text-center mt-4" style="display: none;">
            <img src="{{ asset('img/empty.png') }}" alt="Aucun résultat" class="mb-3">
            <p>Aucun terrain ne correspond à votre recherche</p>
        </div>

        <!-- Boutons -->
        <div class="text-center mt-5">
            <a href="{{ path('app_reservation_index') }}" class="btn-mes-reservations">Mes Réservations</a>
            <a href="{{ path('app_terrain_newfront') }}" class="btn-mes-reservations">Nouveau Terrain</a>
        </div>
    </div>
</section>
{% endblock %}

{% block css %}
<style>
    .terrain_section {
        padding-top: 120px;
        padding-bottom: 80px;
        background-color: #f8f9fa;
    }

    .heading_container {
        text-align: center;
        margin-bottom: 45px;
    }

    /* Style du champ de recherche */
    #searchInput {
        border-radius: 25px;
        padding: 12px 20px;
        border: 2px solid #007bff;
        transition: all 0.3s ease;
    }

    #searchInput:focus {
        box-shadow: 0 0 8px rgba(0,123,255,0.25);
        border-color: #0056b3;
        outline: none;
    }

    .terrain-card {
        background-color: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        height: 100%;
        display: flex;
        flex-direction: column;
        transition: transform 0.3s ease;
    }

    .terrain-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }

    /* Animation des résultats */
    .col-lg-4.col-md-6.mb-4 {
        transition: all 0.3s ease;
    }

    /* Message aucun résultat */
    #noResults {
        animation: fadeIn 0.5s ease;
    }

    #noResults p {
        color: #6c757d;
        font-size: 1.2rem;
        margin-top: 15px;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Reste du CSS existant... */
</style>
{% endblock %}

{% block javascripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput');
    const terrainContainer = document.getElementById('terrainContainer');
    const terrainCards = document.querySelectorAll('.col-lg-4.col-md-6.mb-4');
    const noResults = document.getElementById('noResults');

    searchInput.addEventListener('input', function() {
        const searchTerm = this.value.trim().toLowerCase();
        let visibleCount = 0;

        terrainCards.forEach(card => {
            const content = card.textContent.toLowerCase();
            const isVisible = content.includes(searchTerm);
            
            card.style.display = isVisible ? 'block' : 'none';
            if(isVisible) visibleCount++;
        });

        // Gestion du message "Aucun résultat"
        noResults.style.display = visibleCount === 0 ? 'block' : 'none';
        terrainContainer.style.display = visibleCount === 0 ? 'none' : 'flex';
    });
});
</script>
{% endblock %}