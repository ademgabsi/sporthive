<!DOCTYPE html>
<html>
	<head>
		<!-- Basic -->
		<meta charset="utf-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<!-- Mobile Metas -->
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
		<!-- Site Metas -->
		<meta name="keywords" content=""/>
		<meta name="description" content=""/>
		<meta name="author" content=""/>

		<title>{% block title %}SPORTHIVE{% endblock %}</title>

		<!-- slider stylesheet -->
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css"/>

		<!-- bootstrap core css -->
		<link rel="stylesheet" type="text/css" href="{{ asset('css/bootstrap.css') }}"/>

		<!-- fonts style -->
		<link href="https://fonts.googleapis.com/css?family=Poppins:400,600,700&display=swap" rel="stylesheet">
		<!-- Custom styles for this template -->
		<link href="{{ asset('css/style.css') }}" rel="stylesheet"/>
		<!-- responsive style -->
		<link href="{{ asset('css/responsive.css') }}" rel="stylesheet"/>
		{% block css %}
		
<style>
    #chat-button {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 55px;
        height: 55px;
        background: linear-gradient(135deg, #007bff, #00d4ff);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        cursor: pointer;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
        z-index: 1000;
    }

    #chat-container {
        position: fixed;
        bottom: 90px;
        right: 20px;
        width: 350px;
        background: #fff;
        border-radius: 15px;
        box-shadow: 0px 6px 20px rgba(0, 0, 0, 0.2);
        overflow: hidden;
        display: none;
        flex-direction: column;
        z-index: 1000;
    }

    .chat-box {
        padding: 15px;
        height: 300px;
        overflow-y: auto;
        background: #f9f9f9;
        display: flex;
        flex-direction: column;
    }

    .message {
        max-width: 75%;
        padding: 10px 15px;
        margin: 5px 0;
        border-radius: 20px;
        word-wrap: break-word;
        font-size: 14px;
    }

    .user-message {
        background: #007bff;
        color: #fff;
        align-self: flex-end;
    }

    .bot-message {
        background: #e0e0e0;
        color: #000;
        align-self: flex-start;
    }

    .input-box {
        display: flex;
        padding: 10px;
        background: #fff;
        border-top: 1px solid #ddd;
    }

    .input-box input {
        flex: 1;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 20px;
        outline: none;
    }

    .input-box button {
        background: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        margin-left: 10px;
        border-radius: 20px;
        cursor: pointer;
    }

    .input-box button:hover {
        background: #0056b3;
    }
</style>
		
		
		{% endblock %}
	</head>

	<body>
		<div class="hero_area">
			<!-- header section strats -->
			{% block header %}
				<header >
					<div class="container-fluid">
						<nav class="navbar navbar-expand-lg custom_nav-container">
							<a class="navbar-brand" href="{{ path('app_home') }}">
								<span>SPORTHIVE</span>
							</a>
							<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
								<span class="navbar-toggler-icon"></span>
							</button>

							<div class="collapse navbar-collapse" id="navbarSupportedContent">
								<div class="d-flex ml-auto flex-column flex-lg-row align-items-center">
									<ul class="navbar-nav">
										<li class="nav-item active">
											<a class="nav-link" href="{{ path('app_home') }}">Home</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="{{ path('app_assurance_index') }}">Assurance</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="{{path('index_front')}}">Equipes</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="{{path('index_front_joueur')}}">Joueurs</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="#">Competition</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="#">Match</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="#">Terrain</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="#">Contact Us</a>
										</li>
									</ul>
									<div class="user_option">
										<form class="form-inline my-2 my-lg-0 ml-0 ml-lg-4 mb-3 mb-lg-0">
											<button class="btn my-2 my-sm-0 nav_search-btn" type="submit"></button>
										</form>
									</div>
								</div>
							</div>
						</nav>
					</div>
				</header>
			{% endblock %}

			<!-- Main content section -->
			{% block body %}{% endblock %}

			<!-- Footer section -->
			{% block footer %}
			<br>
			<br>
				<!-- info section -->
				<section class="info_section layout_padding2">
					<div class="container">
						<div class="info_items">
							<a href="">
								<div class="item">
									<div class="img-box box-1">
									</div>
									<div class="detail-box">
										<p>Tunisia, Tunis</p>
									</div>
								</div>
							</a>
							<a href="">
								<div class="item">
									<div class="img-box box-2">
									</div>
									<div class="detail-box">
										<p>+216 123456789</p>
									</div>
								</div>
							</a>
							<a href="">
								<div class="item">
									<div class="img-box box-3">
									</div>
									<div class="detail-box">
										<p>sporthive@gmail.com</p>
									</div>
								</div>
							</a>
						</div>
					</div>
				</section>
				<!-- end info_section -->

				<!-- footer section -->
				<footer class="container-fluid footer_section">
					<p>&copy; 2025 All Rights Reserved.</p>
				</footer>
			{% endblock %}
		</div>

		<script src="{{ asset('js/jquery-3.4.1.min.js') }}"></script>
		<script src="{{ asset('js/bootstrap.js') }}"></script>

		{% block js %}
<script>
    let lastEquipeId = null;

    $(document).ready(function() {
        // On rÃ©cupÃ¨re l'ID actuel le plus Ã©levÃ©
        $.get("{{ path('check_latest_equipe') }}", function(data) {
            lastEquipeId = data.id;
        });

        // VÃ©rification toutes les 5 secondes
        setInterval(function() {
            $.get("{{ path('check_latest_equipe') }}", function(data) {
                if (data.id > lastEquipeId) {
                    showNotification("Nouvelle Ã©quipe ajoutÃ©e : " + data.nom);
                    lastEquipeId = data.id;
                }
            });
        }, 5000);
    });

    function showNotification(message) {
        let notif = $('<div></div>', {
            text: message,
            css: {
                position: 'fixed',
                top: '20px',
                right: '20px',
                background: '#17a2b8',
                color: '#fff',
                padding: '15px 25px',
                'border-radius': '8px',
                'box-shadow': '0 4px 10px rgba(0,0,0,0.2)',
                'z-index': 9999,
                'font-weight': 'bold'
            }
        }).hide().fadeIn();

        $('body').append(notif);

        setTimeout(function() {
            notif.fadeOut(function() { $(this).remove(); });
        }, 6000);
    }
</script>

<script>
    $(document).ready(function () {
        $("#chat-button").click(function () {
            $("#chat-container").fadeToggle();
        });

        $("#send-btn").click(function () {
            sendMessage();
        });

        $("#user-message").keypress(function (e) {
            if (e.which == 13) {
                sendMessage();
            }
        });

        function sendMessage() {
            var userMessage = $("#user-message").val().trim();
            if (userMessage === "") return;

            $("#chat-box").append('<div class="message user-message">' + userMessage + '</div>');
            $("#user-message").val("");
            $("#chat-box").scrollTop($("#chat-box")[0].scrollHeight);

            $.ajax({
                url: "{{ path('chatbot_gemini') }}",
                type: "POST",
                data: { message: userMessage },
                dataType: "json",
                success: function (response) {
                    $("#chat-box").append('<div class="message bot-message">' + response.bot + '</div>');
                    $("#chat-box").scrollTop($("#chat-box")[0].scrollHeight);
                },
                error: function() {
                    $("#chat-box").append('<div class="message bot-message">Erreur de connexion au chatbot.</div>');
                }
            });
        }
    });
</script>
{% endblock %}


<!-- Bouton flottant -->
<div id="chat-button">ðŸ’¬</div>

<!-- Conteneur du chat -->
<div id="chat-container">
    <div class="chat-box" id="chat-box"></div>
    <div class="input-box">
        <input type="text" id="user-message" placeholder="Ã‰crivez un message...">
        <button id="send-btn">Envoyer</button>
    </div>
</div>

	</body>
</html>
