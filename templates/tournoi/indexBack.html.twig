{% extends 'Back/base.html.twig' %}

{% block title %}Tournoi index{% endblock %}

{% block body %}
    <h1>Liste des Tournois</h1>



<table id="tournoiTable" class="table display">
    <thead>
        <tr>
            <th>Nom</th>
            <th>Date d√©but</th>
            <th>Date fin</th>
            <th>Lieu</th>
            <th>Actions</th>
            <th>Comp√©tition</th>
        </tr>
    </thead>
    <tbody>
        {% for tournoi in tournois %}
            <tr>
                <td>{{ tournoi.nom }}</td>
                <td>{{ tournoi.dateDebut ? tournoi.dateDebut|date('Y-m-d') : '' }}</td>
                <td>{{ tournoi.dateFin ? tournoi.dateFin|date('Y-m-d') : '' }}</td>
                <td>{{ tournoi.lieu }}</td>
                <td>
                    <a href="{{ path('app_tournoi_showBack', {'id': tournoi.id}) }}">voir</a>
                    <a href="{{ path('app_tournoi_edit', {'id': tournoi.id}) }}">modifier</a>
                </td>
                <td>{{ tournoi.Competition.Nom }}</td>
            </tr>
        {% else %}
            <tr>
                <td colspan="6">No records found</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

    <a href="{{ path('app_tournoi_new') }}" class="create-btn">cr√©er un nouveau tournoi </a>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <!-- DataTable JS -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // üîç Live Search
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("keyup", function () {
                const value = this.value.toLowerCase();
                document.querySelectorAll("#tournoiTable tbody tr").forEach(row => {
                    row.style.display = row.textContent.toLowerCase().includes(value) ? "" : "none";
                });
            });

            // üìä DataTables Init (optional with sort)
            if (window.jQuery && $.fn.dataTable) {
                $('#tournoiTable').DataTable({
                    order: [[1, 'desc']],
                    paging: false,
                    searching: false, // Disable default search
                    info: false,
                    language: {
                        paginate: { next: "‚Üí", previous: "‚Üê" }
                    }
                });
            }
        });
    </script>

    <!-- TableExport (PDF Export) -->
   <script src="https://cdn.jsdelivr.net/npm/tableexport@5.2.0/dist/js/tableexport.min.js"></script>

<script>
    function exportTable() {
        const table = document.querySelector("#tournoiTable");
        const exportInstance = new TableExport(table, {
            formats: ['pdf'], // üëâ uniquement PDF
            filename: "tournois_export",
            exportButtons: false
        });
        exportInstance.export2file(table, 'pdf');
    }
</script>

{% endblock %}
